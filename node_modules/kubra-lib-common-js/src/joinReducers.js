import Immutable from 'seamless-immutable';

export function joinReducers(subReducers) {
  return (state, action) => {
    const isInitializing = state === undefined;
    const initialState = Immutable.from({});
    return subReducers.reduce(
      (nextState, reducer) => {
        if (isInitializing) {
          return Immutable.merge(nextState, reducer(undefined, action));
        }
        return Immutable.merge(nextState, reducer(nextState, action));
      }, state || initialState);
  };
}

export default {
  joinReducers,
};
